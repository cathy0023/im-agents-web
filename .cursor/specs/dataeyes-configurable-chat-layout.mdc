# DataEyeså¯é…ç½®èŠå¤©å¸ƒå±€è®¾è®¡è§„èŒƒ (SDC)

## ğŸ¯ è®¾è®¡æ¦‚è¿°

æœ¬è§„èŒƒå®šä¹‰äº†DataEyesé¡µé¢çš„å¯é…ç½®èŠå¤©åŠŸèƒ½å¸ƒå±€å’Œäº¤äº’è®¾è®¡ã€‚è¯¥è®¾è®¡åŸºäºç°æœ‰çš„ç»„ä»¶æ¶æ„ï¼Œé€šè¿‡é‡æ–°ç»„è£…ç°æœ‰ç»„ä»¶æ¥å®ç°ä¸€ä¸ªè‡ªé€‚åº”çš„åŒæ¨¡å¼å¸ƒå±€ç³»ç»Ÿã€‚

## ğŸ“‹ åŠŸèƒ½éœ€æ±‚

### æ ¸å¿ƒéœ€æ±‚
1. **é»˜è®¤æ¨¡å¼**: DataEyesé»˜è®¤ä¸ºçº¯æ•°æ®åˆ†æå±•ç¤ºé¡µé¢ï¼Œæ˜¾ç¤ºå›¾è¡¨å’Œç»Ÿè®¡æ•°æ®
2. **èŠå¤©æ¨¡å¼**: å¯é…ç½®å¯ç”¨èŠå¤©åŠŸèƒ½ï¼Œæ”¯æŒç”¨æˆ·ä¸æ•°æ®åˆ†æAIäº¤äº’
3. **åŠ¨æ€å¸ƒå±€**: èŠå¤©åŠŸèƒ½æ¿€æ´»æ—¶ï¼Œå¸ƒå±€è‡ªåŠ¨è°ƒæ•´ä¸ºå·¦å³åˆ†å‰²æ¨¡å¼
4. **æ— ç¼åˆ‡æ¢**: ç”¨æˆ·å¯ä»¥é€šè¿‡æµ®åŠ¨èŠå¤©æ°”æ³¡éšæ—¶æ¿€æ´»/å…³é—­èŠå¤©åŠŸèƒ½

## ğŸ—ï¸ ç»„ä»¶æ¶æ„è®¾è®¡

### ç°æœ‰ç»„ä»¶å¤ç”¨ç­–ç•¥
```
å¤ç”¨ç»„ä»¶:
â”œâ”€â”€ ChartArea       // æ•°æ®å›¾è¡¨åŒºåŸŸ (æ— éœ€ä¿®æ”¹)
â”œâ”€â”€ ChatArea        // èŠå¤©å¯¹è¯åŒºåŸŸ (æ— éœ€ä¿®æ”¹)  
â”œâ”€â”€ MessageInput    // æ¶ˆæ¯è¾“å…¥ç»„ä»¶ (ä»FooterBarä¸­æå–)
â””â”€â”€ å¸ƒå±€ç»„ä»¶æ¡†æ¶     // åŸºäºMessageLayouté‡æ„
```

### æ–°å¢ç»„ä»¶éœ€æ±‚
```
æ–°å¢ç»„ä»¶:
â”œâ”€â”€ ChatBubble         // æµ®åŠ¨èŠå¤©æ°”æ³¡
â”œâ”€â”€ DataEyesLayout     // DataEyesä¸“ç”¨å¸ƒå±€å®¹å™¨
â””â”€â”€ AdaptiveContainer  // è‡ªé€‚åº”å®¹å™¨ (ç®¡ç†å¸ƒå±€åˆ‡æ¢)
```

## ğŸ¨ å¸ƒå±€å½¢æ€è®¾è®¡

### 1. é»˜è®¤æ¨¡å¼å¸ƒå±€ (çº¯æ•°æ®åˆ†æ)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Header Bar                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚                                                         â”‚
â”‚                 ChartArea                               â”‚
â”‚             (å…¨å±æ•°æ®å±•ç¤º)                                â”‚
â”‚                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚     â”‚ğŸ’¬ Chat   â”‚                                        â”‚
â”‚     â”‚ Bubble   â”‚                                        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. èŠå¤©æ¿€æ´»æ¨¡å¼å¸ƒå±€ (1:1åˆ†å‰²)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Header Bar                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚                           â”‚
â”‚         ChatArea            â”‚        ChartArea          â”‚
â”‚      (èŠå¤©å¯¹è¯åŒºåŸŸ)          â”‚      (å›¾è¡¨æ•°æ®åŒºåŸŸ)        â”‚
â”‚                             â”‚                           â”‚
â”‚                             â”‚                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚
â”‚      MessageInput           â”‚                           â”‚
â”‚     (æ¶ˆæ¯è¾“å…¥æ¡†)             â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ äº¤äº’æµç¨‹è®¾è®¡

### èŠå¤©æ°”æ³¡äº¤äº’
```mermaid
graph TD
    A[é»˜è®¤çŠ¶æ€: æ˜¾ç¤ºèŠå¤©æ°”æ³¡] --> B[ç”¨æˆ·ç‚¹å‡»èŠå¤©æ°”æ³¡]
    B --> C[æ°”æ³¡æ·¡å‡º/éšè—]
    C --> D[ChatAreaä»å·¦ä¾§æ¨å…¥]
    D --> E[ChartAreaç§»åŠ¨åˆ°å³ä¾§]
    E --> F[MessageInputæ˜¾ç¤ºåœ¨åº•éƒ¨]
    F --> G[èŠå¤©æ¨¡å¼æ¿€æ´»]
    
    G --> H[ç”¨æˆ·å¯å…³é—­èŠå¤©]
    H --> I[ChatAreaæ¨å‡º]
    I --> J[ChartAreaæ‰©å±•åˆ°å…¨å±]
    J --> K[èŠå¤©æ°”æ³¡é‡æ–°æ˜¾ç¤º]
    K --> A
```

### å¸ƒå±€åˆ‡æ¢åŠ¨ç”»
- **è¿›å…¥èŠå¤©æ¨¡å¼**: 
  - æ°”æ³¡æ·¡å‡º (200ms)
  - ChatAreaä»å·¦ä¾§æ»‘å…¥ (300ms ease-out)
  - ChartAreaå¹³æ»‘è°ƒæ•´å®½åº¦ (300ms ease-out) 
  - MessageInputä»åº•éƒ¨å‡èµ· (250ms ease-out)

- **é€€å‡ºèŠå¤©æ¨¡å¼**:
  - MessageInputä¸‹æ²‰éšè— (200ms)
  - ChatAreaå‘å·¦ä¾§æ»‘å‡º (300ms ease-in)
  - ChartAreaæ‰©å±•åˆ°å…¨å± (300ms ease-in)
  - èŠå¤©æ°”æ³¡æ·¡å…¥ (250ms delay)

## ğŸ›ï¸ ç»„ä»¶æ¥å£è®¾è®¡

### DataEyesLayoutç»„ä»¶æ¥å£
```typescript
interface DataEyesLayoutProps {
  // æ˜¯å¦å¯ç”¨èŠå¤©åŠŸèƒ½
  chatEnabled?: boolean
  
  // èŠå¤©çŠ¶æ€æ§åˆ¶
  isChatActive?: boolean
  onChatToggle?: (active: boolean) => void
  
  // æ•°æ®é…ç½®
  chartData?: any
  agentId?: number
  
  // æ ·å¼å®šåˆ¶
  className?: string
  chatBubblePosition?: 'bottom-left' | 'bottom-right'
}
```

### ChatBubbleç»„ä»¶æ¥å£  
```typescript
interface ChatBubbleProps {
  // æ˜¾ç¤ºçŠ¶æ€
  visible: boolean
  
  // ä½ç½®é…ç½®
  position?: 'bottom-left' | 'bottom-right'
  offset?: { x: number; y: number }
  
  // äº¤äº’å›è°ƒ
  onClick: () => void
  
  // æ ·å¼é…ç½®
  size?: 'sm' | 'md' | 'lg'
  variant?: 'default' | 'primary' | 'outline'
  
  // åŠ¨ç”»é…ç½®
  animation?: boolean
  pulse?: boolean
}
```

### AdaptiveContainerç»„ä»¶æ¥å£
```typescript
interface AdaptiveContainerProps {
  // å¸ƒå±€æ¨¡å¼
  mode: 'chart-only' | 'chat-active'
  
  // å­ç»„ä»¶
  chartComponent: React.ReactNode
  chatComponent?: React.ReactNode
  inputComponent?: React.ReactNode
  
  // åŠ¨ç”»é…ç½®
  transition?: {
    duration: number
    easing: string
  }
  
  // å¸ƒå±€é…ç½®
  splitRatio?: number // é»˜è®¤0.5 (1:1åˆ†å‰²)
}
```

## ğŸ¯ çŠ¶æ€ç®¡ç†è®¾è®¡

### èŠå¤©çŠ¶æ€æ‰©å±•
```typescript
// æ‰©å±•ç°æœ‰chatStore
interface DataEyesChatState {
  // ç°æœ‰çŠ¶æ€ä¿æŒä¸å˜
  ...existing_chat_state
  
  // æ–°å¢DataEyesä¸“ç”¨çŠ¶æ€
  dataEyesConfig: {
    chatEnabled: boolean        // æ˜¯å¦å¯ç”¨èŠå¤©
    isChatActive: boolean      // èŠå¤©æ˜¯å¦æ¿€æ´»
    bubbleVisible: boolean     // æ°”æ³¡æ˜¯å¦å¯è§
    layoutMode: 'chart-only' | 'chat-active'  // å¸ƒå±€æ¨¡å¼
  }
  
  // æ–°å¢åŠ¨ä½œ
  toggleDataEyesChat: () => void
  setDataEyesChatEnabled: (enabled: boolean) => void
  setDataEyesLayoutMode: (mode: string) => void
}
```

## ğŸ¨ æ ·å¼è§„èŒƒ

### èŠå¤©æ°”æ³¡æ ·å¼
```typescript
// åŸºç¡€æ ·å¼
const chatBubbleStyles = {
  base: "fixed z-50 rounded-full shadow-lg border transition-all duration-200",
  sizes: {
    sm: "w-12 h-12",
    md: "w-16 h-16", 
    lg: "w-20 h-20"
  },
  variants: {
    default: "bg-background text-foreground border-border hover:bg-accent",
    primary: "bg-primary text-primary-foreground border-primary hover:bg-primary/90",
    outline: "bg-background text-muted-foreground border-border hover:bg-accent"
  },
  positions: {
    'bottom-left': "bottom-6 left-6",
    'bottom-right': "bottom-6 right-6"
  }
}
```

### å¸ƒå±€è¿‡æ¸¡æ ·å¼
```css
/* å¹³æ»‘å¸ƒå±€è¿‡æ¸¡ */
.adaptive-container {
  transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
}

.chat-area-enter {
  transform: translateX(-100%);
  opacity: 0;
}

.chat-area-enter-active {
  transform: translateX(0);
  opacity: 1;
  transition: all 300ms ease-out;
}

.chat-area-exit {
  transform: translateX(0);
  opacity: 1;
}

.chat-area-exit-active {
  transform: translateX(-100%);
  opacity: 0;
  transition: all 300ms ease-in;
}
```

## ğŸ“± å“åº”å¼è®¾è®¡

### æ¡Œé¢ç«¯ (>1024px)
- èŠå¤©æ°”æ³¡ä½ç½®: å·¦ä¸‹è§’
- åˆ†å‰²æ¯”ä¾‹: 1:1 (ChatArea : ChartArea)
- åŠ¨ç”»: å®Œæ•´è¿‡æ¸¡åŠ¨ç”»

### å¹³æ¿ç«¯ (768px - 1024px)  
- èŠå¤©æ°”æ³¡ä½ç½®: å·¦ä¸‹è§’
- åˆ†å‰²æ¯”ä¾‹: 2:3 (ChatArea : ChartArea)
- åŠ¨ç”»: ç®€åŒ–è¿‡æ¸¡åŠ¨ç”»

### ç§»åŠ¨ç«¯ (<768px)
- èŠå¤©æ°”æ³¡ä½ç½®: å·¦ä¸‹è§’
- å¸ƒå±€æ¨¡å¼: å…¨å±åˆ‡æ¢ (ChatAreaå…¨å±è¦†ç›–)
- åŠ¨ç”»: æ»‘åŠ¨åˆ‡æ¢

## ğŸ”§ æŠ€æœ¯å®ç°è¦ç‚¹

### 1. ç»„ä»¶é‡æ„ç­–ç•¥
```typescript
// ä»FooterBarä¸­æå–MessageInput
// åŸæœ‰FooterBarä¿æŒå‘åå…¼å®¹
export const MessageInput = ({ /* props */ }) => {
  // åŸæœ‰MessageInputé€»è¾‘
}

// åˆ›å»ºç‹¬ç«‹çš„ChatInputAreaç»„ä»¶
export const ChatInputArea = ({ agentId, className }: ChatInputAreaProps) => {
  return (
    <div className={cn("border-t border-border bg-background p-4", className)}>
      <MessageInput placeholder="è¯·è¾“å…¥æ•°æ®åˆ†æé—®é¢˜..." />
    </div>
  )
}
```

### 2. å¸ƒå±€åŠ¨ç”»å®ç°
```typescript
// ä½¿ç”¨framer-motionæˆ–CSS transitions
import { AnimatePresence, motion } from 'framer-motion'

const AdaptiveContainer = ({ mode, children }) => {
  return (
    <div className="flex h-full">
      <AnimatePresence>
        {mode === 'chat-active' && (
          <motion.div
            initial={{ x: '-100%', opacity: 0 }}
            animate={{ x: 0, opacity: 1 }}
            exit={{ x: '-100%', opacity: 0 }}
            transition={{ duration: 0.3, ease: 'easeOut' }}
            className="flex-1"
          >
            {chatComponent}
          </motion.div>
        )}
      </AnimatePresence>
      
      <motion.div
        animate={{ 
          width: mode === 'chat-active' ? '50%' : '100%' 
        }}
        transition={{ duration: 0.3, ease: 'easeOut' }}
        className="h-full"
      >
        {chartComponent}
      </motion.div>
    </div>
  )
}
```

### 3. çŠ¶æ€æŒä¹…åŒ–
```typescript
// ä¿å­˜ç”¨æˆ·çš„èŠå¤©åå¥½è®¾ç½®
const useDataEyesPreferences = () => {
  const [preferences, setPreferences] = useLocalStorage('dataEyesPreferences', {
    chatEnabled: true,
    bubblePosition: 'bottom-left',
    defaultChatActive: false
  })
  
  return { preferences, setPreferences }
}
```

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- [ ] èŠå¤©æ°”æ³¡åœ¨é»˜è®¤æ¨¡å¼ä¸‹æ­£ç¡®æ˜¾ç¤º
- [ ] ç‚¹å‡»æ°”æ³¡èƒ½æ­£ç¡®æ¿€æ´»èŠå¤©æ¨¡å¼
- [ ] å¸ƒå±€åˆ‡æ¢åŠ¨ç”»æµç•…è‡ªç„¶
- [ ] ChatAreaå’ŒChartAreaåœ¨èŠå¤©æ¨¡å¼ä¸‹1:1åˆ†å‰²
- [ ] MessageInputåœ¨èŠå¤©æ¨¡å¼ä¸‹æ­£ç¡®æ˜¾ç¤ºå’ŒåŠŸèƒ½æ­£å¸¸
- [ ] å¯ä»¥æ­£ç¡®å…³é—­èŠå¤©æ¨¡å¼è¿”å›é»˜è®¤å¸ƒå±€
- [ ] åŸæœ‰FooterBaråŠŸèƒ½ç§»é™¤ä¸”ä¸å½±å“å…¶ä»–é¡µé¢

### æ€§èƒ½éªŒæ”¶
- [ ] å¸ƒå±€åˆ‡æ¢åŠ¨ç”»å¸§ç‡ >60fps
- [ ] ç»„ä»¶çŠ¶æ€åˆ‡æ¢å“åº”æ—¶é—´ <100ms
- [ ] å†…å­˜å ç”¨æ— æ˜æ˜¾å¢é•¿
- [ ] ä¸å½±å“ChartAreaçš„æ¸²æŸ“æ€§èƒ½

### å…¼å®¹æ€§éªŒæ”¶
- [ ] æ”¯æŒæ‰€æœ‰ä¸»æµæµè§ˆå™¨
- [ ] å“åº”å¼å¸ƒå±€åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹æ­£ç¡®æ˜¾ç¤º
- [ ] æ”¯æŒè§¦æ‘¸è®¾å¤‡äº¤äº’
- [ ] æ— éšœç¢è®¿é—®å…¼å®¹

## ğŸš€ å®æ–½è®¡åˆ’

### é˜¶æ®µ1: ç»„ä»¶æå–å’Œé‡æ„ (1-2å¤©)
1. ä»FooterBaræå–MessageInputä¸ºç‹¬ç«‹ç»„ä»¶
2. åˆ›å»ºChatInputAreaç»„ä»¶
3. è®¾è®¡ChatBubbleç»„ä»¶
4. æ›´æ–°ç°æœ‰ç»„ä»¶å¼•ç”¨

### é˜¶æ®µ2: å¸ƒå±€å®¹å™¨å¼€å‘ (2-3å¤©) 
1. å¼€å‘AdaptiveContainerç»„ä»¶
2. å®ç°DataEyesLayoutç»„ä»¶
3. é›†æˆåŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ
4. å“åº”å¼å¸ƒå±€é€‚é…

### é˜¶æ®µ3: çŠ¶æ€ç®¡ç†é›†æˆ (1å¤©)
1. æ‰©å±•chatStoreçŠ¶æ€
2. å®ç°çŠ¶æ€æŒä¹…åŒ–
3. é›†æˆç»„ä»¶çŠ¶æ€ç®¡ç†

### é˜¶æ®µ4: æµ‹è¯•å’Œä¼˜åŒ– (1-2å¤©)
1. åŠŸèƒ½æµ‹è¯•
2. æ€§èƒ½ä¼˜åŒ–
3. å…¼å®¹æ€§æµ‹è¯•
4. ç”¨æˆ·ä½“éªŒä¼˜åŒ–

## ğŸ“š å‚è€ƒèµ„æº

- ç°æœ‰ç»„ä»¶: `src/components/MessageLayout.tsx` (å¸ƒå±€å‚è€ƒ)
- ç°æœ‰ç»„ä»¶: `src/components/ChartArea.tsx` (å›¾è¡¨åŒºåŸŸ)
- ç°æœ‰ç»„ä»¶: `src/components/ChatArea.tsx` (èŠå¤©åŒºåŸŸ)
- ç°æœ‰ç»„ä»¶: `src/components/FooterBar.tsx` (è¾“å…¥ç»„ä»¶å‚è€ƒ)
- çŠ¶æ€ç®¡ç†: `src/store/chatStore.ts` (çŠ¶æ€æ‰©å±•å‚è€ƒ)
- æ ·å¼ç³»ç»Ÿ: shadcn UI + Tailwind CSS
- åŠ¨ç”»åº“: framer-motion (æ¨è) æˆ– CSS Transitions

---

*æœ¬æ–‡æ¡£åŸºäºSDCè®¾è®¡ç†å¿µåˆ›å»ºï¼Œæä¾›äº†å®Œæ•´çš„è®¾è®¡è§„èŒƒã€æŠ€æœ¯å®ç°å’ŒéªŒæ”¶æ ‡å‡†ï¼Œä¸ºå¼€å‘å›¢é˜Ÿæä¾›æ¸…æ™°çš„å®æ–½æŒ‡å¯¼ã€‚*