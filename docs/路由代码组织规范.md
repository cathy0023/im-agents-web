# è·¯ç”±ä»£ç ç»„ç»‡è§„èŒƒ

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

åœ¨åŒå±‚ Features æ¶æ„ä¸‹ï¼Œè·¯ç”±ä»£ç é‡‡ç”¨**åˆ†å±‚ç»„ç»‡**ç­–ç•¥ï¼š

```
å…¨å±€è·¯ç”±é…ç½®ï¼ˆåº”ç”¨çº§ï¼‰
    â†“
ä¸šåŠ¡æ¨¡å—è·¯ç”±ï¼ˆåŠŸèƒ½çº§ï¼‰
    â†“
å…·ä½“é¡µé¢ç»„ä»¶
```

---

## ğŸ“ è·¯ç”±ä»£ç æ”¾ç½®ä½ç½®

### 1. å…¨å±€è·¯ç”±é…ç½® - `src/app/router.tsx` âœ…

**èŒè´£**ï¼šåº”ç”¨çº§è·¯ç”±é…ç½®å’Œè·¯ç”±ç»„åˆ

```typescript
// âœ… src/app/router.tsx - å…¨å±€è·¯ç”±é…ç½®
import { createBrowserRouter } from 'react-router-dom'
import App from '@/App'

// å¯¼å…¥å„ä¸šåŠ¡æ¨¡å—çš„è·¯ç”±
import { chatRoutes } from '@/business-features/chat/routes'
import { agentsRoutes } from '@/business-features/agents/routes'
import { contactsRoutes } from '@/business-features/contacts/routes'
import { analyticsRoutes } from '@/business-features/analytics/routes'

export const router = createBrowserRouter([
  {
    path: '/',
    element: <App />,
    children: [
      // ç»„åˆå„ä¸šåŠ¡æ¨¡å—çš„è·¯ç”±
      ...chatRoutes,
      ...agentsRoutes,
      ...contactsRoutes,
      ...analyticsRoutes,
      
      // å…¨å±€è·¯ç”±ï¼ˆå¦‚ 404ï¼‰
      {
        path: '*',
        element: <NotFound />
      }
    ]
  }
])
```

#### å…¨å±€è·¯ç”±é…ç½®å†…å®¹

| æ–‡ä»¶ | èŒè´£ | å…¸å‹å†…å®¹ |
|------|------|---------|
| `src/app/router.tsx` | è·¯ç”±ç»„åˆå’Œé…ç½® | è·¯ç”±å™¨åˆ›å»ºã€è·¯ç”±ç»„åˆã€å…¨å±€è·¯ç”±ï¼ˆ404ã€ç™»å½•ï¼‰ |
| `src/app/provider.tsx` | å…¨å±€ Provider | RouterProviderã€ThemeProviderã€I18nProvider |
| `src/app/index.tsx` | åº”ç”¨å…¥å£ | App ç»„ä»¶å¯¼å‡º |

---

### 2. ä¸šåŠ¡æ¨¡å—è·¯ç”± - `src/business-features/[feature]/routes/` âœ…

**èŒè´£**ï¼šå„ä¸šåŠ¡åŠŸèƒ½çš„å®Œæ•´è·¯ç”±å®šä¹‰

#### ç›®å½•ç»“æ„

```
src/business-features/
â”œâ”€â”€ chat/
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ index.ts          # å¯¼å‡ºè·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ ChatRoutes.tsx    # è·¯ç”±å®šä¹‰ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â””â”€â”€ routeConfig.ts    # è·¯ç”±å…ƒæ•°æ®ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ ChatPage.tsx      # èŠå¤©é¡µé¢
â”‚   â”‚   â”œâ”€â”€ ChatHistory.tsx   # å†å²è®°å½•é¡µé¢
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ AgentsPage.tsx
â”‚   â”‚   â”œâ”€â”€ AgentDetail.tsx
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ ...
```

#### ä¸šåŠ¡æ¨¡å—è·¯ç”±ç¤ºä¾‹

```typescript
// âœ… src/business-features/chat/routes/index.ts
import { RouteObject } from 'react-router-dom'
import { ChatPage } from '../pages/ChatPage'
import { ChatHistory } from '../pages/ChatHistory'

// å¯¼å‡ºèŠå¤©æ¨¡å—çš„è·¯ç”±é…ç½®
export const chatRoutes: RouteObject[] = [
  {
    path: '/chat',
    element: <ChatPage />,
    children: [
      {
        path: ':conversationId',
        element: <ChatPage />
      }
    ]
  },
  {
    path: '/chat/history',
    element: <ChatHistory />
  }
]

// è·¯ç”±å…ƒæ•°æ®ï¼ˆå¯é€‰ï¼‰
export const chatRouteMeta = {
  basePath: '/chat',
  title: 'chat.title',
  icon: 'MessageSquare',
  requiresAuth: true
}
```

```typescript
// âœ… src/business-features/agents/routes/index.ts
import { RouteObject } from 'react-router-dom'
import { AgentsPage } from '../pages/AgentsPage'
import { AgentDetail } from '../pages/AgentDetail'

export const agentsRoutes: RouteObject[] = [
  {
    path: '/agents',
    element: <AgentsPage />
  },
  {
    path: '/agents/:agentId',
    element: <AgentDetail />
  }
]

export const agentsRouteMeta = {
  basePath: '/agents',
  title: 'agents.title',
  icon: 'Bot',
  requiresAuth: true
}
```

---

### 3. é¡µé¢ç»„ä»¶ - `src/business-features/[feature]/pages/` âœ…

**èŒè´£**ï¼šå…·ä½“çš„é¡µé¢çº§ç»„ä»¶

```typescript
// âœ… src/business-features/chat/pages/ChatPage.tsx
import { useParams } from 'react-router-dom'
import { ChatArea, ConversationList } from '../components'

export const ChatPage = () => {
  const { conversationId } = useParams()
  
  return (
    <div className="flex h-full bg-background">
      <ConversationList />
      <ChatArea conversationId={conversationId} />
    </div>
  )
}
```

```typescript
// âœ… src/business-features/chat/pages/index.ts
export { ChatPage } from './ChatPage'
export { ChatHistory } from './ChatHistory'
```

---

### 4. è·¯ç”±å·¥å…·å’Œç±»å‹ - `src/types/router.ts` âœ…

**èŒè´£**ï¼šå…¨å±€è·¯ç”±ç›¸å…³çš„ç±»å‹å®šä¹‰å’Œå·¥å…·å‡½æ•°

```typescript
// âœ… src/types/router.ts - å…¨å±€è·¯ç”±ç±»å‹
import { RouteObject } from 'react-router-dom'

// è·¯ç”±å…ƒæ•°æ®ç±»å‹
export interface RouteMeta {
  basePath: string
  title: string
  icon?: string
  requiresAuth?: boolean
  roles?: string[]
}

// æ‰©å±•çš„è·¯ç”±å¯¹è±¡
export interface AppRouteObject extends RouteObject {
  meta?: RouteMeta
  children?: AppRouteObject[]
}

// è·¯ç”±é…ç½®ç±»å‹
export interface RouteConfig {
  routes: RouteObject[]
  meta?: RouteMeta
}

// å¯¼èˆªé¡¹ç±»å‹
export interface NavigationItem {
  path: string
  label: string
  icon?: string
  children?: NavigationItem[]
}
```

---

## ğŸ“Š è·¯ç”±ä»£ç åˆ†å¸ƒå›¾

```
src/
â”œâ”€â”€ app/                                    # åº”ç”¨çº§é…ç½® (10%)
â”‚   â”œâ”€â”€ router.tsx                         # âœ… å…¨å±€è·¯ç”±ç»„åˆ
â”‚   â”œâ”€â”€ provider.tsx                       # âœ… å…¨å±€ Provider
â”‚   â””â”€â”€ index.tsx                          # âœ… åº”ç”¨å…¥å£
â”‚
â”œâ”€â”€ business-features/                     # ä¸šåŠ¡æ¨¡å— (80%)
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ routes/                       # âœ… èŠå¤©è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ index.ts                  # è·¯ç”±é…ç½®å¯¼å‡º
â”‚   â”‚   â”œâ”€â”€ pages/                        # âœ… èŠå¤©é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatHistory.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ routes/                       # âœ… Agents è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ pages/                        # âœ… Agents é¡µé¢
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ contacts/
â”‚   â”‚   â”œâ”€â”€ routes/                       # âœ… è”ç³»äººè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ pages/                        # âœ… è”ç³»äººé¡µé¢
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ analytics/
â”‚       â”œâ”€â”€ routes/                       # âœ… åˆ†æè·¯ç”±
â”‚       â”œâ”€â”€ pages/                        # âœ… åˆ†æé¡µé¢
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ components/                            # å…¨å±€ç»„ä»¶
â”‚   â””â”€â”€ layout/
â”‚       â”œâ”€â”€ AppLayout.tsx                 # åº”ç”¨å¸ƒå±€
â”‚       â””â”€â”€ NotFound.tsx                  # 404 é¡µé¢
â”‚
â””â”€â”€ types/                                 # å…¨å±€ç±»å‹ (10%)
    â””â”€â”€ router.ts                         # âœ… è·¯ç”±ç±»å‹å®šä¹‰
```

---

## ğŸ¯ å®é™…æ¡ˆä¾‹å¯¹æ¯”

### æ¡ˆä¾‹ 1ï¼šèŠå¤©åŠŸèƒ½çš„è·¯ç”±ç»„ç»‡

#### âŒ é”™è¯¯ï¼šè·¯ç”±é›†ä¸­åœ¨å…¨å±€

```typescript
// âŒ src/app/router.tsx - æ‰€æœ‰è·¯ç”±éƒ½å†™åœ¨è¿™é‡Œ
export const router = createBrowserRouter([
  {
    path: '/',
    element: <App />,
    children: [
      // èŠå¤©è·¯ç”±
      { path: '/chat', element: <ChatPage /> },
      { path: '/chat/:conversationId', element: <ChatPage /> },
      { path: '/chat/history', element: <ChatHistory /> },
      
      // Agents è·¯ç”±
      { path: '/agents', element: <AgentsPage /> },
      { path: '/agents/:agentId', element: <AgentDetail /> },
      
      // ... æ›´å¤šè·¯ç”±ï¼ˆæ··ä¹±ã€éš¾ç»´æŠ¤ï¼‰
    ]
  }
])
```

**é—®é¢˜**ï¼š
- âŒ æ‰€æœ‰è·¯ç”±æ··åœ¨ä¸€èµ·ï¼Œéš¾ä»¥ç»´æŠ¤
- âŒ æ— æ³•ç‹¬ç«‹ç®¡ç†ä¸šåŠ¡æ¨¡å—çš„è·¯ç”±
- âŒ ä¿®æ”¹èŠå¤©åŠŸèƒ½éœ€è¦ä¿®æ”¹å…¨å±€è·¯ç”±æ–‡ä»¶

#### âœ… æ­£ç¡®ï¼šè·¯ç”±åˆ†æ¨¡å—ç®¡ç†

```typescript
// âœ… src/business-features/chat/routes/index.ts
export const chatRoutes: RouteObject[] = [
  {
    path: '/chat',
    element: <ChatPage />,
    children: [
      { path: ':conversationId', element: <ChatPage /> }
    ]
  },
  {
    path: '/chat/history',
    element: <ChatHistory />
  }
]

// âœ… src/app/router.tsx - ç®€æ´çš„å…¨å±€è·¯ç”±
import { chatRoutes } from '@/business-features/chat/routes'
import { agentsRoutes } from '@/business-features/agents/routes'

export const router = createBrowserRouter([
  {
    path: '/',
    element: <App />,
    children: [
      ...chatRoutes,      // èŠå¤©è·¯ç”±
      ...agentsRoutes,    // Agents è·¯ç”±
      // ... å…¶ä»–æ¨¡å—è·¯ç”±
    ]
  }
])
```

**ä¼˜åŠ¿**ï¼š
- âœ… æ¯ä¸ªä¸šåŠ¡æ¨¡å—ç®¡ç†è‡ªå·±çš„è·¯ç”±
- âœ… å…¨å±€è·¯ç”±æ–‡ä»¶ç®€æ´æ¸…æ™°
- âœ… ä¿®æ”¹èŠå¤©è·¯ç”±åªéœ€è¦ä¿®æ”¹èŠå¤©æ¨¡å—

---

### æ¡ˆä¾‹ 2ï¼šå¸¦æƒé™çš„è·¯ç”±

```typescript
// âœ… src/business-features/agents/routes/index.ts
import { ProtectedRoute } from '@/core-features/auth/components'
import { AgentsPage } from '../pages/AgentsPage'

export const agentsRoutes: RouteObject[] = [
  {
    path: '/agents',
    element: (
      <ProtectedRoute requiredRoles={['admin', 'user']}>
        <AgentsPage />
      </ProtectedRoute>
    )
  }
]

// è·¯ç”±å…ƒæ•°æ®
export const agentsRouteMeta = {
  basePath: '/agents',
  title: 'agents.title',
  icon: 'Bot',
  requiresAuth: true,
  roles: ['admin', 'user']
}
```

---

### æ¡ˆä¾‹ 3ï¼šåµŒå¥—è·¯ç”±

```typescript
// âœ… src/business-features/analytics/routes/index.ts
import { AnalyticsLayout } from '../components/AnalyticsLayout'
import { Dashboard } from '../pages/Dashboard'
import { Reports } from '../pages/Reports'
import { Charts } from '../pages/Charts'

export const analyticsRoutes: RouteObject[] = [
  {
    path: '/analytics',
    element: <AnalyticsLayout />,
    children: [
      {
        index: true,
        element: <Dashboard />
      },
      {
        path: 'reports',
        element: <Reports />
      },
      {
        path: 'charts',
        element: <Charts />
      }
    ]
  }
]
```

---

## ğŸ”„ è·¯ç”±å¯¼èˆªå’Œé“¾æ¥

### åœ¨ç»„ä»¶ä¸­ä½¿ç”¨è·¯ç”±

```typescript
// âœ… ä½¿ç”¨ react-router-dom çš„å¯¼èˆª
import { useNavigate, useParams, Link } from 'react-router-dom'

const ChatComponent = () => {
  const navigate = useNavigate()
  const { conversationId } = useParams()
  
  const handleNavigate = () => {
    navigate('/chat/123')
  }
  
  return (
    <div>
      <Link to="/chat" className="text-primary hover:underline">
        è¿”å›èŠå¤©åˆ—è¡¨
      </Link>
      <button onClick={handleNavigate}>è·³è½¬åˆ°ä¼šè¯</button>
    </div>
  )
}
```

### å¯¼èˆªèœå•é…ç½®

```typescript
// âœ… src/config/navigation.ts - å…¨å±€å¯¼èˆªé…ç½®
import { NavigationItem } from '@/types/router'
import { chatRouteMeta } from '@/business-features/chat/routes'
import { agentsRouteMeta } from '@/business-features/agents/routes'

export const mainNavigation: NavigationItem[] = [
  {
    path: chatRouteMeta.basePath,
    label: chatRouteMeta.title,
    icon: chatRouteMeta.icon
  },
  {
    path: agentsRouteMeta.basePath,
    label: agentsRouteMeta.title,
    icon: agentsRouteMeta.icon
  },
  // ... å…¶ä»–å¯¼èˆªé¡¹
]
```

---

## âœ… å†³ç­–æµç¨‹å›¾

```
éœ€è¦åˆ›å»ºè·¯ç”±ç›¸å…³ä»£ç 
          â†“
     æ˜¯åº”ç”¨çº§çš„è·¯ç”±ç»„åˆï¼Ÿ
          â†“
    æ˜¯ â†’ æ”¾åœ¨ src/app/router.tsx
    å¦ â†’ ç»§ç»­åˆ¤æ–­
          â†“
     æ˜¯ç‰¹å®šä¸šåŠ¡åŠŸèƒ½çš„è·¯ç”±ï¼Ÿ
          â†“
    æ˜¯ â†’ æ”¾åœ¨ src/business-features/[feature]/routes/
    å¦ â†’ ç»§ç»­åˆ¤æ–­
          â†“
     æ˜¯é¡µé¢ç»„ä»¶ï¼Ÿ
          â†“
    æ˜¯ â†’ æ”¾åœ¨ src/business-features/[feature]/pages/
    å¦ â†’ ç»§ç»­åˆ¤æ–­
          â†“
     æ˜¯å…¨å±€è·¯ç”±ç±»å‹æˆ–å·¥å…·ï¼Ÿ
          â†“
    æ˜¯ â†’ æ”¾åœ¨ src/types/router.ts
    å¦ â†’ æ”¾åœ¨ src/config/navigation.tsï¼ˆå¯¼èˆªé…ç½®ï¼‰
```

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### åˆ›å»ºæ–°è·¯ç”±å‰æ£€æŸ¥

- [ ] **ç¡®å®šæ˜¯å…¨å±€è·¯ç”±è¿˜æ˜¯ä¸šåŠ¡è·¯ç”±ï¼Ÿ**
  - å…¨å±€è·¯ç”± â†’ `src/app/router.tsx`
  - ä¸šåŠ¡è·¯ç”± â†’ `src/business-features/[feature]/routes/`

- [ ] **æ˜¯å¦éœ€è¦é¡µé¢ç»„ä»¶ï¼Ÿ**
  - éœ€è¦ â†’ åœ¨ `src/business-features/[feature]/pages/` åˆ›å»º

- [ ] **æ˜¯å¦éœ€è¦è·¯ç”±å®ˆå«ï¼ˆæƒé™ï¼‰ï¼Ÿ**
  - éœ€è¦ â†’ ä½¿ç”¨ `core-features/auth/components/ProtectedRoute`

- [ ] **æ˜¯å¦éœ€è¦è·¯ç”±å…ƒæ•°æ®ï¼Ÿ**
  - éœ€è¦ â†’ åœ¨è·¯ç”±æ–‡ä»¶ä¸­å¯¼å‡º `routeMeta`

- [ ] **æ˜¯å¦éœ€è¦å¯¼èˆªèœå•é…ç½®ï¼Ÿ**
  - éœ€è¦ â†’ åœ¨ `src/config/navigation.ts` ä¸­é…ç½®

---

## ğŸ¯ æ€»ç»“

### è·¯ç”±ä»£ç æ”¾ç½®ä½ç½®

| è·¯ç”±ç±»å‹ | æ”¾ç½®ä½ç½® | èŒè´£ | ç¤ºä¾‹ |
|---------|---------|------|------|
| **åº”ç”¨çº§è·¯ç”±** | `src/app/router.tsx` | è·¯ç”±ç»„åˆã€å…¨å±€é…ç½® | è·¯ç”±å™¨åˆ›å»ºã€404 è·¯ç”± |
| **ä¸šåŠ¡è·¯ç”±** | `src/business-features/[feature]/routes/` | ä¸šåŠ¡åŠŸèƒ½çš„è·¯ç”±å®šä¹‰ | èŠå¤©è·¯ç”±ã€Agents è·¯ç”± |
| **é¡µé¢ç»„ä»¶** | `src/business-features/[feature]/pages/` | é¡µé¢çº§ç»„ä»¶ | ChatPageã€AgentsPage |
| **è·¯ç”±ç±»å‹** | `src/types/router.ts` | å…¨å±€è·¯ç”±ç±»å‹ | RouteMetaã€RouteConfig |
| **å¯¼èˆªé…ç½®** | `src/config/navigation.ts` | å¯¼èˆªèœå•é…ç½® | mainNavigation |

### æ ¸å¿ƒåŸåˆ™

1. **åˆ†å±‚ç®¡ç†**ï¼šåº”ç”¨çº§ â†’ ä¸šåŠ¡çº§ â†’ é¡µé¢çº§
2. **æ¨¡å—è‡ªåŒ…å«**ï¼šæ¯ä¸ªä¸šåŠ¡æ¨¡å—ç®¡ç†è‡ªå·±çš„è·¯ç”±å’Œé¡µé¢
3. **ç»Ÿä¸€ç»„åˆ**ï¼šåœ¨åº”ç”¨çº§ç»Ÿä¸€ç»„åˆæ‰€æœ‰è·¯ç”±
4. **ç±»å‹å®‰å…¨**ï¼šä½¿ç”¨ TypeScript ç¡®ä¿è·¯ç”±ç±»å‹å®‰å…¨

**è®°ä½ï¼šè·¯ç”±é…ç½®åº”è¯¥éšç€åŠŸèƒ½æ¨¡å—èµ°ï¼Œä¸è¦é›†ä¸­åœ¨å…¨å±€ï¼**

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-13  
**ç»´æŠ¤å›¢é˜Ÿ**: IM Agents Web å‰ç«¯å›¢é˜Ÿ

