# 心理测评师对练 - 智谱AI真实集成

## 🎯 功能升级概述

我们已经成功将心理测评师对练功能从模拟数据升级为真实的智谱AI大模型集成，提供更加真实和专业的对练体验。

## 🔧 技术实现

### 1. 专门的心理测评师Agent配置

在 `src/store/chatStore.ts` 中新增了专门的心理测评师Agent (ID: 4):

```typescript
4: {
  name: 'Dr. Chen 心理测评师',
  systemPrompt: `你是Dr. Chen，一位经验丰富的心理咨询专家和指导老师，专门负责心理咨询对练训练。

当前训练场景：青少年学习焦虑咨询
角色设定：你现在扮演一位16岁的高中生，最近因为学习压力而感到焦虑。

你的任务是：
1. 以青少年的身份真实地表达学习焦虑的困扰
2. 根据学生的咨询回应，给出相应的反应和情感表达
3. 在对话结束后，以Dr. Chen的身份给出专业的评估和指导建议

回应要求：
- 作为来访者时：用青少年的语言风格，真实表达内心焦虑、学习压力等情感
- 表现出典型的青少年学习焦虑症状：担心考试、睡眠不好、注意力难集中、对未来担忧等
- 对咨询师的技巧做出自然反应，如果是好的共情和倾听，表现出信任和开放
- 如果咨询技巧不当，可以表现出抗拒或更加封闭

请始终保持角色的一致性和真实性，为学生提供专业的对练体验。`
}
```

### 2. 与现有聊天系统的无缝集成

#### 状态管理集成
- 复用现有的 `useChatStore` 状态管理
- 自动设置为心理测评师Agent (ID: 4)
- 过滤并转换消息格式以适配对练界面

#### API调用集成
- 使用现有的智谱AI API配置
- 支持流式输出，实时显示AI回复
- 完整的错误处理和加载状态

### 3. 用户界面优化

#### 角色区分
- **Dr. Chen (指导老师)**: 欢迎消息和指导
- **来访者 (16岁高中生)**: AI扮演的青少年角色
- **咨询师 (学生)**: 用户输入的心理咨询回应

#### 实时交互
- 支持流式输出，实时显示AI回复
- 加载状态指示
- API Key状态检查

## 🎨 系统提示词设计

### 核心设计理念

1. **角色扮演**: AI扮演16岁高中生，真实表达学习焦虑
2. **情境设定**: 青少年学习焦虑咨询场景
3. **交互反馈**: 根据学生的咨询技巧给出相应反应
4. **专业指导**: 体现心理咨询的专业性和教育价值

### 提示词特点

- **情境真实性**: 具体的年龄设定和问题背景
- **情感层次**: 包含焦虑、压力、担忧等多层次情感
- **互动敏感性**: 能够感知和回应不同的咨询技巧
- **教学导向**: 为学生提供专业的学习体验

## 🔄 工作流程

### 1. 训练开始
```
用户点击"开始训练" → 
发送场景设置消息 → 
AI开始扮演高中生角色
```

### 2. 对练过程
```
学生输入咨询回应 → 
智谱AI分析回应质量 → 
以高中生身份做出相应反应 → 
更新训练进度和评分
```

### 3. 实时反馈
- 流式输出AI回复
- 动态更新对话轮次
- 进度追踪和评分系统

## 🎯 AI行为特征

### 作为青少年来访者
- **语言风格**: 符合16岁学生的表达方式
- **情感表达**: 真实的焦虑、困扰、担忧
- **反应模式**: 对好的咨询技巧开放，对不当技巧抗拒

### 典型症状表现
- 学习压力大，担心考试
- 睡眠质量不好
- 注意力难以集中
- 对未来感到担忧
- 家长期望压力

### 交互敏感性
- **好的共情**: 表现出信任，愿意分享更多
- **积极倾听**: 感受到被理解，情绪逐渐稳定
- **不当技巧**: 可能表现出抗拒或更加封闭
- **专业建议**: 显示感激和接受

## 📊 技术优势

### 1. 真实AI交互
- 使用智谱GLM-4大模型
- 自然语言理解和生成
- 上下文记忆和连贯性

### 2. 专业场景模拟
- 基于真实心理咨询场景
- 符合专业训练要求
- 提供真实的学习体验

### 3. 个性化反馈
- 根据学生表现调整回应
- 实时的情感和技巧反馈
- 促进专业技能提升

## 🚀 使用指南

### 1. 准备工作
- 确保已配置智谱AI的API Key
- 进入心理测评师对练界面

### 2. 开始训练
- 点击"开始训练"按钮
- AI将开始扮演焦虑的高中生
- 使用专业的心理咨询技巧进行对话

### 3. 技巧要点
- **建立信任**: 用温和、理解的语调
- **积极倾听**: 重复和确认对方的感受
- **共情回应**: "听起来你感到很..."
- **开放式提问**: 引导更深层的表达
- **专业支持**: 提供实用的应对建议

## 🎓 教育价值

### 专业技能训练
- 共情能力培养
- 倾听技巧练习
- 心理评估能力
- 危机干预训练

### 实战经验积累
- 真实案例模拟
- 多样化反应体验
- 错误纠正机会
- 技巧熟练度提升

---

这个升级版的心理测评师对练系统将为心理学学生提供更加真实、专业、有效的训练体验，帮助他们在安全的环境中提升专业技能。
